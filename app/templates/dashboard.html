{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<h2 style="
    margin-bottom:30px;
    font-size:26px;
    font-weight:600;
">
    Welcome back, {{ username }} üëã
</h2>


{% macro anime_section(title, anime_list) %}

    <!-- Section Header -->
    <h3 style="
        margin:50px 0 20px 0;
        font-size:20px;
        font-weight:600;
        border-left:4px solid #ff4c4c;
        padding-left:12px;
    ">
        {{ title }}
    </h3>

    <!-- Grid -->
    <div style="
        display:grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap:24px;
    ">

        {% for anime in anime_list %}
        <a href="{{ url_for('main_bp.anime_detail', anime_id=anime['mal_id']) }}"
           style="text-decoration:none; color:white;">

            <div style="
                background:#1e1e1e;
                border-radius:16px;
                overflow:hidden;
                box-shadow:0 6px 18px rgba(0,0,0,0.45);
                transition: all 0.25s ease;
            "
            onmouseover="this.style.transform='scale(1.06)'"
            onmouseout="this.style.transform='scale(1)'">

                <!-- Poster Container -->
                <div style="position:relative;">

                    <img src="{{ anime['images']['jpg']['image_url'] }}"
                         style="
                            width:100%;
                            height:260px;
                            object-fit:cover;
                         ">

                    <!-- Rating Badge -->
                    {% if anime['score'] %}
                    <div style="
                        position:absolute;
                        top:12px;
                        right:12px;
                        background:#ff4c4c;
                        padding:6px 10px;
                        border-radius:10px;
                        font-size:12px;
                        font-weight:600;
                        box-shadow:0 3px 10px rgba(0,0,0,0.5);
                    ">
                        ‚≠ê {{ anime['score'] }}
                    </div>
                    {% endif %}

                </div>

                <!-- Anime Title -->
                <div style="padding:14px;">
                    <p style="
                        font-size:14px;
                        font-weight:500;
                        color:#f1f1f1;
                        line-height:1.4;
                        min-height:40px;
                    ">
                        {{ anime['title'][:45] }}
                        {% if anime['title']|length > 45 %}...{% endif %}
                    </p>
                </div>

            </div>

        </a>
        {% endfor %}

    </div>

{% endmacro %}


{{ anime_section("üèÜ Top Rated Anime", top_anime) }}
{{ anime_section("üå∏ Currently Airing", seasonal_anime) }}
{{ anime_section("‚≠ê Most Popular Anime", popular_anime) }}

{% endblock %}